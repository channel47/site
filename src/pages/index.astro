---
/**
 * Homepage - Founder Journey Landing Page (V6)
 *
 * Refined editorial design with authentic Claude Code terminal.
 * Unified typography, wider content, reserved CTAs.
 *
 * Changes from V5:
 * - Wider content area on desktop for breathing room
 * - Authentic Claude Code terminal showing conversational interaction
 * - Simplified, inline email optins
 * - Unified headline typography (fewer font/color variations)
 */
import BaseLayout from '../layouts/BaseLayout.astro';
import Prose from '../components/Prose.astro';
import EmailSignup from '../components/EmailSignup.astro';
import LogoAnimated from '../components/LogoAnimated.astro';
import SocialLinks from '../components/SocialLinks.astro';
import AnimatedName from '../components/AnimatedName.astro';
---

<BaseLayout
  title="Channel47 — Claude Code plugin for media buyers"
  description="A free Claude Code plugin for Google Ads. You prompt, it audits and fixes. Built by someone who can't code."
>
  <main class="page">
    <!-- Atmospheric orb - subtle warmth behind content -->
    <div class="atmosphere" aria-hidden="true">
      <div class="atmosphere__orb"></div>
    </div>

    <Prose width="wide">
      <!-- Hero: Claim → Cliffhanger → Payoff -->
      <header class="hero">
        <p class="hero__overline" data-animate="fade-up" data-stagger="1">A Claude Code Plugin for Google Ads</p>
        <h1 class="hero__headline" data-animate="blur-in" data-stagger="2">
          Stop clicking. Start prompting.
        </h1>

        <!-- Claude Code terminal - animated conversation -->
        <div class="claude-terminal" data-animate="fade-up" data-stagger="2" data-terminal-animate>
          <div class="claude-terminal__chrome">
            <div class="claude-terminal__dots">
              <span></span><span></span><span></span>
            </div>
            <div class="claude-terminal__title">claude</div>
          </div>
          <div class="claude-terminal__content">
            <!-- Beat 1: The Ask -->
            <div class="claude-terminal__message claude-terminal__message--user" data-beat="1">
              <span class="claude-terminal__prompt">›</span>
              <span class="claude-terminal__text" data-typewriter>Audit my campaigns for RSA best practices and find any missing extensions</span>
            </div>

            <!-- Thinking indicator (shown between beats) -->
            <div class="claude-terminal__thinking" data-thinking="1" aria-live="polite">
              <span class="claude-terminal__thinking-spinner"></span>
              <span class="claude-terminal__thinking-text">Thinking</span>
            </div>

            <!-- Beat 2: The Discovery -->
            <div class="claude-terminal__message claude-terminal__message--claude" data-beat="2">
              <div class="claude-terminal__claude-indicator" data-reveal="indicator">
                <span class="claude-terminal__claude-icon">●</span>
                <span class="claude-terminal__claude-name">Claude</span>
              </div>
              <div class="claude-terminal__response">
                <p class="claude-terminal__response-text" data-reveal="text">I'll check your campaigns for RSA best practices and scan for missing extensions.</p>
                <div class="claude-terminal__tool" data-reveal="tool">
                  <span class="claude-terminal__tool-label">Read</span>
                  <span class="claude-terminal__tool-target">23 campaigns · 89 ad groups · 156 RSAs</span>
                </div>
                <p class="claude-terminal__response-text" data-reveal="text">Found 4 campaigns missing sitelinks, 3 callout gaps, and 2 campaigns need structured snippets.</p>
              </div>
            </div>

            <!-- Beat 3: The Decision -->
            <div class="claude-terminal__message claude-terminal__message--user" data-beat="3">
              <span class="claude-terminal__prompt">›</span>
              <span class="claude-terminal__text" data-typewriter>Fix them</span>
            </div>

            <!-- Thinking indicator before action -->
            <div class="claude-terminal__thinking" data-thinking="2" aria-live="polite">
              <span class="claude-terminal__thinking-spinner"></span>
              <span class="claude-terminal__thinking-text">Writing</span>
            </div>

            <!-- Beat 4: The Action -->
            <div class="claude-terminal__message claude-terminal__message--claude" data-beat="4">
              <div class="claude-terminal__claude-indicator" data-reveal="indicator">
                <span class="claude-terminal__claude-icon">●</span>
                <span class="claude-terminal__claude-name">Claude</span>
              </div>
              <div class="claude-terminal__response">
                <p class="claude-terminal__response-text" data-reveal="text">Adding the missing extensions now.</p>
                <div class="claude-terminal__tool claude-terminal__tool--write" data-reveal="tool">
                  <span class="claude-terminal__tool-label">Write</span>
                  <span class="claude-terminal__tool-target">4 sitelinks · 3 callouts · 2 structured snippets</span>
                </div>
              </div>
            </div>

            <!-- Thinking indicator before consecutive Claude message -->
            <div class="claude-terminal__thinking" data-thinking="4" aria-live="polite">
              <span class="claude-terminal__thinking-spinner"></span>
              <span class="claude-terminal__thinking-text">Thinking</span>
            </div>

            <!-- Beat 5: The Payoff -->
            <div class="claude-terminal__message claude-terminal__message--claude claude-terminal__message--final" data-beat="5">
              <div class="claude-terminal__response">
                <p class="claude-terminal__response-text claude-terminal__response-text--success" data-reveal="text">Done. All extensions live. Your accounts are compliant.</p>
              </div>
            </div>
          </div>
          <!-- Fade overlay for cliffhanger effect -->
          <div class="claude-terminal__fade" aria-hidden="true"></div>
        </div>
      </header>

      <!-- CTA: Inline, reserved -->
      <div class="cta cta--inline" data-animate="fade-up" data-stagger="3">
        <p class="cta__context">I'll send you the setup walkthrough, plus updates as I ship new features.</p>
        <EmailSignup placeholder="your@email.com" tag="hero" />
        <p class="cta__hint">Free and open source. Requires Claude Pro (~$20/mo).</p>
      </div>

      <!-- Origin: Dense story block -->
      <section class="story story--origin" data-animate="fade-up" data-stagger="4">
        <p class="story__lede">
          A year ago I lived inside the Google Ads UI. Twenty-five accounts. Hundreds of campaigns. The same clicks. Over and over.
        </p>
        <p>
          Check the search terms. Click. Click. Click.<br />
          Scan the extensions. Click. Click.<br />
          Review the RSAs. Click. Click. Click.
        </p>
        <p>
          I wasn't managing campaigns. I was pushing buttons.
        </p>
        <p>
          Then I started experimenting with Claude—not for ads at first. I was curious. I asked it to pull some data. It wrote a script. I asked for another. That worked too.
        </p>
        <p class="story__pull">
          I kept asking. It kept building.
        </p>
        <p>
          Somewhere along the way I stopped thinking of Claude as a tool and started thinking of it as the developer I could never afford. One who writes thousands of lines while I describe what I need in plain English.
        </p>
        <p>
          I can't code. But I can describe what I want. Turns out, that's enough now.
        </p>
        <p>
          Now my workflow lives in the terminal. That probably sounds intimidating. It's not. It's a text window. You type what you want. Claude does the rest.
        </p>
        <p>
          So I packaged what I built: an open-source Claude Code plugin for Google Ads. Audits, edits, reports—describe what you need. Still building.
        </p>
        <p>
          Built for media buyers. Free forever. You just need Claude Pro (~$20/mo).
        </p>
      </section>

      <section class="faq" data-animate="fade-up" data-stagger="4">
        <div class="faq__item">
          <h3 class="faq__question">How does it work?</h3>
          <p class="faq__answer">
            Everything runs on your machine. You use your own Claude Pro subscription and connect your own Google Ads API credentials. Nothing passes through my servers—I never see your data or account access.
          </p>
        </div>
        <div class="faq__item">
          <h3 class="faq__question">Why free?</h3>
          <p class="faq__answer">
            I don't need your money. I need your feedback. Use the plugin. Break it. Tell me what's broken. That's the deal.
          </p>
        </div>
        <div class="faq__item">
          <h3 class="faq__question">What about my accounts?</h3>
          <p class="faq__answer">
            The plugin can read and modify your data, but only when you ask. Claude shows you what it's about to do and waits for approval. You stay in control.
          </p>
        </div>
      </section>

      <!-- The Belief: Tightened worldview statement -->
      <section class="story story--belief" data-animate="fade-up" data-stagger="4">
        <p class="story__manifesto">
          The tools are temporary. The understanding compounds.
        </p>
        <p>
          AI will handle most of this eventually. That's exactly why now matters—while you can still see the seams, still learn how it works underneath. The ones who do will be ready for whatever comes next.
        </p>
      </section>

      <!-- Final CTA: Value exchange -->
      <section class="invitation" data-animate="fade-up" data-stagger="5">
        <div class="invitation__content">
          <h2 class="invitation__headline">Start prompting in 15 minutes</h2>
          <p class="invitation__description">
            Connect your MCC. Follow one walkthrough. Then describe what you need.
          </p>
          <div class="invitation__form">
            <EmailSignup placeholder="your@email.com" tag="setup-guide" />
          </div>
          <p class="invitation__cadence">
            I'll send the setup guide and new features as I ship them. No courses. No pitch decks. Just the plugin getting better.
          </p>
        </div>
      </section>

      <!-- Footer: Minimal, breathing -->
      <footer class="page-footer" data-animate="fade-up" data-stagger="5">
        <div class="page-footer__left">
          <div class="page-footer__logo">
            <LogoAnimated delay={200} />
          </div>
          <p class="page-footer__attribution">
            Built by <AnimatedName alias="ctrlswing" realName="Jackson" />
          </p>
        </div>
        <div class="page-footer__social">
          <SocialLinks />
        </div>
      </footer>
    </Prose>
  </main>
</BaseLayout>

<style>
  /* =========================================
   * PAGE LAYOUT
   * Full viewport, generous whitespace
   * ========================================= */
  .page {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    min-height: 100vh;
    min-height: 100dvh;
    padding-block-start: max(var(--space-12), env(safe-area-inset-top, 0px) + var(--space-6));
    padding-block-end: max(var(--space-16), env(safe-area-inset-bottom, 0px) + var(--space-10));
    position: relative;
    isolation: isolate;
  }

  @media (min-width: 480px) {
    .page {
      padding-block-start: var(--space-16);
      padding-block-end: var(--space-20);
    }
  }

  @media (min-width: 768px) {
    .page {
      padding-block-start: var(--space-20);
      padding-block-end: var(--space-24);
    }
  }

  @media (min-width: 1024px) {
    .page {
      padding-block-start: var(--space-24);
    }
  }

  @media (min-height: 800px) {
    .page {
      padding-block-start: 8vh;
    }
  }

  /* =========================================
   * ATMOSPHERE
   * Subtle orb effect - positioned behind terminal
   * ========================================= */
  .atmosphere {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: -1;
    overflow: hidden;
  }

  .atmosphere__orb {
    position: absolute;
    top: 10%;
    left: 50%;
    transform: translateX(-50%);
    width: min(750px, 110vw);
    height: min(550px, 75vh);
    background: radial-gradient(
      ellipse 100% 100% at 50% 30%,
      var(--color-accent-glow) 0%,
      oklch(18% 0.02 35 / 0.08) 40%,
      transparent 70%
    );
    filter: blur(var(--blur-2xl));
    animation: orb-drift 25s var(--ease-in-out) infinite;
  }

  @keyframes orb-drift {
    0%, 100% {
      opacity: 0.2;
      transform: translateX(-50%) translateY(0);
    }
    50% {
      opacity: 0.35;
      transform: translateX(-50%) translateY(calc(-1 * var(--space-4)));
    }
  }

  /* =========================================
   * HERO
   * Unified typography: serif headlines, muted second line
   * ========================================= */
  .hero {
    text-align: left;
    margin-bottom: var(--space-12);
  }

  @media (min-width: 768px) {
    .hero {
      margin-bottom: var(--space-16);
    }
  }

  .hero__overline {
    font-family: var(--font-display);
    font-size: var(--text-2xs);
    font-weight: var(--font-semibold);
    letter-spacing: var(--tracking-wider);
    text-transform: uppercase;
    color: var(--color-accent);
    margin: 0 0 var(--space-4) 0;
    opacity: 0.85;
  }

  @media (min-width: 768px) {
    .hero__overline {
      font-size: var(--text-xs);
      margin-bottom: var(--space-5);
    }
  }

  /* Headline - impactful sans-serif display */
  .hero__headline {
    font-family: var(--font-display);
    font-size: clamp(1.875rem, 8vw, 2.75rem);
    font-weight: var(--font-extrabold);
    letter-spacing: var(--optical-display);
    line-height: 1.05;
    color: var(--color-fg);
    margin: 0 0 var(--space-10) 0;
    max-width: 18ch;
    text-shadow: var(--text-shadow-sm);
  }

  @media (min-width: 480px) {
    .hero__headline {
      font-size: clamp(2.25rem, 7vw, 3.5rem);
      letter-spacing: var(--optical-display);
      margin-bottom: var(--space-12);
    }
  }

  @media (min-width: 768px) {
    .hero__headline {
      font-size: clamp(3rem, 5.5vw, 5rem);
      letter-spacing: var(--optical-hero);
      line-height: 1.02;
      margin-bottom: var(--space-14);
    }
  }

  /* =========================================
   * CLAUDE CODE TERMINAL
   * Authentic conversational interface with scroll
   * ========================================= */
  .claude-terminal {
    max-width: 100%;
    background: var(--color-bg-deep);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    overflow: hidden;
    font-family: var(--font-mono);
    font-size: var(--text-xs);
    box-shadow:
      0 4px 24px oklch(0% 0 0 / 0.4),
      0 0 0 1px oklch(100% 0 0 / 0.02) inset,
      0 1px 0 0 oklch(100% 0 0 / 0.04) inset;
    position: relative;
  }

  @media (min-width: 768px) {
    .claude-terminal {
      font-size: var(--text-sm);
      max-width: 680px;
    }
  }

  /* Bottom fade overlay for depth */
  .claude-terminal__fade {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: var(--space-10);
    background: linear-gradient(
      to bottom,
      transparent 0%,
      var(--color-bg-deep) 100%
    );
    pointer-events: none;
    z-index: 2;
    opacity: 0;
    transition: opacity var(--duration-normal) var(--ease-out);
    transition-delay: var(--stagger-2);
  }

  /* Show fade when content is scrollable */
  .claude-terminal.has-overflow .claude-terminal__fade {
    opacity: 1;
  }

  /* Hide fade when scrolled to bottom */
  .claude-terminal.at-bottom .claude-terminal__fade {
    opacity: 0;
  }

  /* Chrome bar */
  .claude-terminal__chrome {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    padding: var(--space-2) var(--space-3);
    background: var(--color-bg-elevated);
    border-bottom: 1px solid var(--color-border-subtle);
  }

  .claude-terminal__dots {
    display: flex;
    gap: var(--space-1);
  }

  .claude-terminal__dots span {
    width: var(--space-2-5);
    height: var(--space-2-5);
    border-radius: var(--radius-full);
  }

  .claude-terminal__dots span:nth-child(1) {
    background: oklch(65% 0.16 25);  /* Warm red from palette */
  }

  .claude-terminal__dots span:nth-child(2) {
    background: oklch(78% 0.14 75);  /* Warm amber/gold */
  }

  .claude-terminal__dots span:nth-child(3) {
    background: oklch(70% 0.14 145); /* Warm green */
  }

  .claude-terminal__title {
    font-size: var(--text-xs);
    color: var(--color-fg-subtle);
    letter-spacing: 0.02em;
  }

  /* Content area - fixed height with scroll */
  .claude-terminal__content {
    padding: var(--space-4);
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
    min-height: 200px;  /* Maintain consistent height during animation */
    max-height: 240px;
    overflow-y: auto;
    /* scroll-behavior handled by JS for better control */

    /* Custom scrollbar */
    scrollbar-width: thin;
    scrollbar-color: var(--color-border) transparent;
  }

  .claude-terminal__content::-webkit-scrollbar {
    width: 6px;
  }

  .claude-terminal__content::-webkit-scrollbar-track {
    background: transparent;
  }

  .claude-terminal__content::-webkit-scrollbar-thumb {
    background: var(--color-border);
    border-radius: 3px;
  }

  .claude-terminal__content::-webkit-scrollbar-thumb:hover {
    background: var(--color-border-subtle);
  }

  @media (min-width: 480px) {
    .claude-terminal__content {
      padding: var(--space-5);
      gap: var(--space-4);
      min-height: 220px;
      max-height: 260px;
    }
  }

  @media (min-width: 768px) {
    .claude-terminal__content {
      padding: var(--space-6);
      gap: var(--space-5);
      min-height: 240px;
      max-height: 300px;
    }
  }

  /* Messages */
  .claude-terminal__message {
    display: flex;
    gap: var(--space-2);
  }

  .claude-terminal__message--user {
    align-items: flex-start;
  }

  .claude-terminal__message--claude {
    flex-direction: column;
    gap: var(--space-2);
  }

  /* User prompt */
  .claude-terminal__prompt {
    color: var(--color-accent);
    font-weight: var(--font-medium);
    flex-shrink: 0;
    user-select: none;
  }

  .claude-terminal__text {
    color: var(--color-fg);
    line-height: var(--leading-relaxed);
  }

  /* Claude indicator */
  .claude-terminal__claude-indicator {
    display: flex;
    align-items: center;
    gap: var(--space-2);
  }

  .claude-terminal__claude-icon {
    color: var(--color-accent);
    font-size: 0.6em;
  }

  .claude-terminal__claude-name {
    font-size: var(--text-xs);
    font-weight: var(--font-medium);
    color: var(--color-fg-muted);
    letter-spacing: 0.01em;
  }

  /* Claude response */
  .claude-terminal__response {
    padding-left: var(--space-4);
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
  }

  .claude-terminal__response-text {
    color: oklch(72% 0.015 55);  /* Slightly warmer than fg-secondary */
    line-height: var(--leading-relaxed);
    margin: 0;
    font-size: 0.95em;
  }

  /* Tool indicators */
  .claude-terminal__tool {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-1) var(--space-2);
    background: var(--color-bg-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    width: fit-content;
  }

  .claude-terminal__tool-label {
    font-size: 0.85em;
    font-weight: var(--font-semibold);
    color: var(--color-fg-secondary);
  }

  .claude-terminal__tool-target {
    font-size: 0.85em;
    color: var(--color-fg-muted);
  }

  .claude-terminal__tool--success .claude-terminal__tool-label {
    color: var(--color-accent);
  }

  /* Write tool variant - subtle differentiation */
  .claude-terminal__tool--write .claude-terminal__tool-label {
    color: var(--color-accent);
  }

  /* Success/final message styling */
  .claude-terminal__response-text--success {
    color: var(--color-fg);
    font-weight: var(--font-medium);
  }

  /* =========================================
   * THINKING INDICATOR
   * Cycles through action words like Claude Code
   * ========================================= */
  .claude-terminal__thinking {
    display: none;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-1) 0;
    opacity: 0;
  }

  .claude-terminal__thinking.is-active {
    display: flex;
    animation: thinking-fade-in var(--duration-fast) var(--ease-out) forwards;
  }

  @keyframes thinking-fade-in {
    from {
      opacity: 0;
      transform: translateY(var(--space-1));
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .claude-terminal__thinking-spinner {
    width: var(--space-3);
    height: var(--space-3);
    border: var(--border-medium) solid var(--color-border);
    border-top-color: var(--color-accent);
    border-radius: var(--radius-full);
    animation: thinking-spin var(--duration-slowest) var(--ease-linear) infinite;
  }

  @keyframes thinking-spin {
    to {
      transform: rotate(360deg);
    }
  }

  .claude-terminal__thinking-text {
    font-size: var(--text-xs);
    color: var(--color-fg-muted);
    font-style: italic;
    letter-spacing: 0.01em;
  }

  /* Ellipsis animation for thinking text */
  .claude-terminal__thinking-text::after {
    content: '';
    animation: thinking-ellipsis var(--duration-extended) steps(4, end) infinite;
  }

  @keyframes thinking-ellipsis {
    0% { content: ''; }
    25% { content: '.'; }
    50% { content: '..'; }
    75% { content: '...'; }
    100% { content: ''; }
  }

  /* Fade out animation for thinking indicator */
  .claude-terminal__thinking.is-fading {
    animation: thinking-fade-out var(--duration-normal) var(--ease-out) forwards;
  }

  @keyframes thinking-fade-out {
    to {
      opacity: 0;
      transform: translateY(calc(-1 * var(--space-1)));
    }
  }

  /* =========================================
   * TERMINAL ANIMATION STATES
   * Progressive reveal system
   *
   * Flow:
   * 1. Terminal content hidden by default (no flash)
   * 2. Terminal fades in via page animation
   * 3. JS marks ready, beats animate in sequence
   * ========================================= */

  /* Hide all beats by default - prevents flash before JS */
  .claude-terminal[data-terminal-animate] [data-beat] {
    opacity: 0;
    transform: translateY(var(--space-3));
    visibility: hidden;
    pointer-events: none;
  }

  /* Hide thinking indicators by default */
  .claude-terminal[data-terminal-animate] .claude-terminal__thinking {
    display: none;
  }

  /* Revealed beats - fade up smoothly */
  .claude-terminal[data-terminal-animate] [data-beat].is-revealed {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
    pointer-events: auto;
    transition:
      opacity var(--duration-slow) var(--ease-snap),
      transform var(--duration-slow) var(--ease-snap),
      visibility 0s;
  }

  /* Elements within beats - hidden until parent reveals */
  .claude-terminal[data-terminal-animate] [data-reveal] {
    opacity: 0;
    transform: translateY(var(--space-1-5));
  }

  .claude-terminal[data-terminal-animate] [data-reveal].is-revealed {
    opacity: 1;
    transform: translateY(0);
    transition:
      opacity var(--duration-normal) var(--ease-snap),
      transform var(--duration-normal) var(--ease-snap);
  }

  /* Tool call - special scale-up entrance */
  .claude-terminal[data-terminal-animate] [data-reveal="tool"] {
    transform: translateY(var(--space-1-5)) scale(0.95);
  }

  .claude-terminal[data-terminal-animate] [data-reveal="tool"].is-revealed {
    transform: translateY(0) scale(1);
    transition:
      opacity var(--duration-slow) var(--ease-snap),
      transform var(--duration-slow) var(--ease-pop);
  }

  /* Typewriter text - container visible, text added by JS */
  .claude-terminal[data-terminal-animate] [data-typewriter] {
    opacity: 1;
  }

  /* Typewriter cursor */
  .claude-terminal__cursor {
    display: inline-block;
    width: var(--border-medium);
    height: 1.1em;
    background: var(--color-accent);
    margin-left: var(--space-px);
    vertical-align: text-bottom;
    animation: cursor-blink var(--duration-slower) var(--ease-in-out) infinite;
  }

  .claude-terminal__cursor--hidden {
    opacity: 0;
    transition: opacity var(--duration-fast) var(--ease-out);
  }

  @keyframes cursor-blink {
    0%, 50% { opacity: 1; }
    51%, 100% { opacity: 0; }
  }

  /* Prompt symbol - pulses when typing completes */
  .claude-terminal__prompt.is-complete {
    animation: prompt-pulse var(--duration-normal) var(--ease-out);
  }

  @keyframes prompt-pulse {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
  }

  /* Final message - subtle glow on reveal */
  .claude-terminal__message--final.is-revealed .claude-terminal__response-text--success {
    animation: success-glow var(--duration-slowest) var(--ease-out);
  }

  @keyframes success-glow {
    0% {
      text-shadow: 0 0 0 transparent;
    }
    40% {
      text-shadow: var(--text-glow-medium);
    }
    100% {
      text-shadow: 0 0 0 transparent;
    }
  }

  /* No-JS fallback: show static content after brief delay
     This only applies if JS never runs */
  @supports (animation-timeline: auto) {
    .claude-terminal[data-terminal-animate]:not([data-animation-ready]) [data-beat] {
      animation: nojs-reveal 0.01ms 2s forwards;
    }
  }

  @keyframes nojs-reveal {
    to {
      opacity: 1;
      transform: none;
      visibility: visible;
    }
  }

  /* Reduced motion - show everything immediately */
  @media (prefers-reduced-motion: reduce) {
    .claude-terminal[data-terminal-animate] [data-beat],
    .claude-terminal[data-terminal-animate] [data-reveal] {
      opacity: 1 !important;
      transform: none !important;
      visibility: visible !important;
      pointer-events: auto !important;
      transition: none !important;
    }

    .claude-terminal[data-terminal-animate] .claude-terminal__thinking {
      display: none !important;
    }

    .claude-terminal__cursor {
      animation: none;
      opacity: 0;
    }

    .claude-terminal__message--final.is-revealed .claude-terminal__response-text--success {
      animation: none;
    }
  }

  /* =========================================
   * INLINE CTA
   * Reserved, inline with content
   * ========================================= */
  .cta--inline {
    margin-bottom: var(--space-16);
    max-width: 360px;
  }

  @media (min-width: 768px) {
    .cta--inline {
      margin-bottom: var(--space-20);
    }
  }

  .cta__context {
    font-family: var(--font-serif);
    font-size: var(--text-sm);
    color: var(--color-fg-secondary);
    line-height: var(--leading-relaxed);
    margin: 0 0 var(--space-4) 0;
    max-width: 36ch;
  }

  @media (min-width: 768px) {
    .cta__context {
      font-size: var(--text-base);
      margin-bottom: var(--space-5);
    }
  }

  .cta__hint {
    font-family: var(--font-serif);
    font-size: var(--text-sm);
    color: var(--color-fg-subtle);
    margin: var(--space-3) 0 0 0;
  }

  /* =========================================
   * STORY SECTIONS
   * Unified serif typography
   * ========================================= */
  .story {
    max-width: var(--measure-prose);
  }

  .story p {
    font-family: var(--font-serif);
    font-size: var(--type-prose-size);
    line-height: var(--leading-relaxed);
    color: var(--color-fg-secondary);
    margin: 0 0 var(--space-6) 0;
  }

  .story p:last-child {
    margin-bottom: 0;
  }

  @media (min-width: 768px) {
    .story p {
      font-size: var(--fluid-lg);
      line-height: var(--leading-prose);
      margin-bottom: var(--space-7);
    }
  }

  /* Origin: Dense, narrative block */
  .story--origin {
    margin-bottom: var(--space-6);
  }

  @media (min-width: 768px) {
    .story--origin {
      margin-bottom: var(--space-8);
    }
  }

  .story__lede {
    font-size: var(--fluid-lg);
    letter-spacing: var(--optical-lg);
    color: var(--color-fg);
    font-weight: var(--font-medium);
    line-height: var(--leading-snug);
    margin-bottom: var(--space-10);
    padding-bottom: var(--space-8);
    border-bottom: 1px solid var(--color-border-subtle);
  }

  @media (min-width: 768px) {
    .story__lede {
      font-size: var(--fluid-xl);
      letter-spacing: var(--optical-xl);
      margin-bottom: var(--space-12);
      padding-bottom: var(--space-10);
    }
  }

  .story__pull {
    font-size: var(--fluid-lg);
    font-weight: var(--font-semibold);
    letter-spacing: var(--optical-lg);
    line-height: var(--leading-snug);
    color: var(--color-fg);
    padding: var(--space-4) 0 var(--space-4) var(--space-5);
    margin: var(--space-10) 0 var(--space-10) 0;
    border-left: 3px solid var(--color-accent);
  }

  @media (min-width: 768px) {
    .story__pull {
      font-size: var(--fluid-2xl);
      letter-spacing: var(--optical-2xl);
      padding: var(--space-5) 0 var(--space-5) var(--space-7);
      margin: var(--space-12) 0 var(--space-12) 0;
    }
  }

  /* Belief section: Manifesto tone */
  .story--belief {
    padding: var(--space-12) 0;
    margin-top: var(--space-10);
    border-top: 1px solid var(--color-border-subtle);
  }

  @media (min-width: 768px) {
    .story--belief {
      padding: var(--space-16) 0;
      margin-top: var(--space-14);
    }
  }

  .story__manifesto {
    font-family: var(--font-display);
    font-size: var(--fluid-xl);
    font-weight: var(--font-bold);
    letter-spacing: var(--optical-xl);
    color: var(--color-fg);
    line-height: var(--leading-tight);
    margin-bottom: var(--space-6);
  }

  @media (min-width: 768px) {
    .story__manifesto {
      font-size: var(--fluid-2xl);
      letter-spacing: var(--optical-2xl);
      margin-bottom: var(--space-8);
    }
  }


  /* =========================================
   * FAQ SECTION
   * Compact Q&A pairs with clear grouping
   * ========================================= */
  .faq {
    display: flex;
    flex-direction: column;
    gap: var(--space-10);
    max-width: var(--measure-prose);
    padding-top: var(--space-8);
  }

  @media (min-width: 768px) {
    .faq {
      gap: var(--space-12);
      padding-top: var(--space-10);
    }
  }

  .faq__item {
    /* Consistent border treatment across breakpoints */
    padding-bottom: var(--space-8);
    border-bottom: 1px solid var(--color-border-subtle);
  }

  .faq__item:last-child {
    padding-bottom: 0;
    border-bottom: none;
  }

  @media (min-width: 768px) {
    .faq__item {
      padding-bottom: var(--space-10);
    }

    .faq__item:last-child {
      padding-bottom: 0;
    }
  }

  .faq__question {
    font-family: var(--font-display);
    font-size: var(--fluid-md);
    font-weight: var(--font-bold);
    letter-spacing: var(--optical-lg);
    color: var(--color-fg);
    margin: 0 0 var(--space-2) 0;
  }

  @media (min-width: 768px) {
    .faq__question {
      font-size: var(--fluid-lg);
      letter-spacing: var(--optical-lg);
      margin-bottom: var(--space-3);
    }
  }

  .faq__answer {
    font-family: var(--font-serif);
    font-size: var(--type-prose-size);
    line-height: var(--leading-relaxed);
    color: var(--color-fg-muted);
    margin: 0;
  }

  @media (min-width: 768px) {
    .faq__answer {
      font-size: var(--fluid-md);
      line-height: var(--leading-prose);
    }
  }

  /* =========================================
   * INVITATION
   * Simple, clean - no card treatment
   * ========================================= */
  .invitation {
    margin-top: var(--space-20);
  }

  @media (min-width: 768px) {
    .invitation {
      margin-top: var(--space-28);
    }
  }

  .invitation__content {
    max-width: var(--measure-prose);
  }

  .invitation__headline {
    font-family: var(--font-display);
    font-size: var(--fluid-2xl);
    font-weight: var(--font-bold);
    letter-spacing: var(--optical-2xl);
    line-height: var(--leading-tight);
    color: var(--color-fg);
    margin: 0 0 var(--space-4) 0;
  }

  @media (min-width: 768px) {
    .invitation__headline {
      font-size: var(--fluid-3xl);
      letter-spacing: var(--optical-display);
      margin-bottom: var(--space-5);
    }
  }

  .invitation__description {
    font-family: var(--font-serif);
    font-size: var(--fluid-md);
    line-height: var(--leading-relaxed);
    color: var(--color-fg-secondary);
    margin: 0 0 var(--space-8) 0;
    max-width: 48ch;
  }

  @media (min-width: 768px) {
    .invitation__description {
      font-size: var(--fluid-lg);
      line-height: var(--leading-relaxed);
      margin-bottom: var(--space-10);
    }
  }

  .invitation__form {
    margin-bottom: var(--space-4);
    max-width: 340px;
  }

  .invitation__cadence {
    font-family: var(--font-serif);
    font-size: var(--text-sm);
    color: var(--color-fg-subtle);
    margin: 0;
    line-height: var(--leading-relaxed);
    max-width: 44ch;
  }

  /* =========================================
   * FOOTER
   * Minimal, lots of breathing room
   * ========================================= */
  .page-footer {
    margin-top: var(--space-28);
    padding-top: var(--space-12);
    border-top: 1px solid var(--color-border-subtle);
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: var(--space-8);
  }

  @media (min-width: 768px) {
    .page-footer {
      margin-top: var(--space-36);
      padding-top: var(--space-14);
      flex-direction: row;
      align-items: center;
      justify-content: space-between;
      gap: var(--space-10);
    }
  }

  @media (min-width: 1024px) {
    .page-footer {
      margin-top: var(--space-40);
      padding-top: var(--space-16);
    }
  }

  .page-footer__left {
    display: flex;
    flex-direction: column;
    gap: var(--space-5);
  }

  @media (min-width: 768px) {
    .page-footer__left {
      flex-direction: row;
      align-items: center;
      gap: var(--space-8);
    }
  }

  /* Footer opacity scale: visible but quiet */
  .page-footer__logo {
    opacity: 0.7;
    transition: opacity var(--duration-normal) var(--ease-out);
  }

  .page-footer__logo:hover {
    opacity: 1;
  }

  .page-footer__attribution {
    font-family: var(--font-serif);
    font-size: var(--text-sm);
    color: var(--color-fg-subtle);
    margin: 0;
    opacity: 0.8;
    transition: opacity var(--duration-normal) var(--ease-out);
  }

  .page-footer__attribution:hover {
    opacity: 1;
  }

  .page-footer__social {
    opacity: 0.5;
    transition: opacity var(--duration-normal) var(--ease-out);
  }

  .page-footer__social:hover {
    opacity: 0.8;
  }

  /* =========================================
   * PAGE ENTRY ANIMATIONS
   * Orchestrated staggered reveal on load
   * ========================================= */
  [data-animate] {
    opacity: 0;
    animation-fill-mode: both;
  }

  /* Fade up - the workhorse entrance */
  [data-animate="fade-up"] {
    animation: page-fade-up var(--duration-slower) var(--ease-snap) both;
  }

  /* Blur in - premium hero effect */
  [data-animate="blur-in"] {
    animation: page-blur-in var(--duration-slowest) var(--ease-snap) both;
  }

  @keyframes page-fade-up {
    from {
      opacity: 0;
      transform: translateY(var(--space-5));
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes page-blur-in {
    from {
      opacity: 0;
      transform: translateY(var(--space-4));
      filter: blur(var(--blur-md));
    }
    to {
      opacity: 1;
      transform: translateY(0);
      filter: blur(0);
    }
  }

  /* Stagger delays - orchestrated timing using tokens */
  [data-stagger="1"] { animation-delay: var(--stagger-1); }
  [data-stagger="2"] { animation-delay: var(--stagger-2); }
  [data-stagger="3"] { animation-delay: var(--stagger-4); }
  [data-stagger="4"] { animation-delay: var(--stagger-6); }
  [data-stagger="5"] { animation-delay: var(--stagger-8); }

  /* =========================================
   * SCROLL-TRIGGERED REVEALS
   * Elements fade in as they enter viewport
   * ========================================= */
  .story,
  .faq,
  .invitation {
    opacity: 0;
    transform: translateY(var(--space-6));
    transition:
      opacity var(--duration-slowest) var(--ease-snap),
      transform var(--duration-slowest) var(--ease-snap);
  }

  .story.is-visible,
  .faq.is-visible,
  .invitation.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* FAQ items stagger within section */
  .faq:not(.is-visible) .faq__item {
    opacity: 0;
    transform: translateY(var(--space-5));
  }

  .faq__item {
    transition:
      opacity var(--duration-slower) var(--ease-snap),
      transform var(--duration-slower) var(--ease-snap);
  }

  .faq.is-visible .faq__item {
    opacity: 1;
    transform: translateY(0);
  }

  .faq.is-visible .faq__item:nth-child(1) { transition-delay: var(--stagger-1); }
  .faq.is-visible .faq__item:nth-child(2) { transition-delay: var(--stagger-3); }
  .faq.is-visible .faq__item:nth-child(3) { transition-delay: var(--stagger-5); }

  /* =========================================
   * TERMINAL HOVER
   * Minimal - just subtle shadow change
   * ========================================= */
  .claude-terminal {
    transition: box-shadow var(--duration-slow) var(--ease-out);
  }

  .claude-terminal:hover {
    box-shadow:
      0 6px 32px oklch(0% 0 0 / 0.5),
      0 0 0 1px oklch(100% 0 0 / 0.03) inset,
      0 1px 0 0 oklch(100% 0 0 / 0.05) inset;
  }

  /* =========================================
   * FAQ HOVER AFFORDANCE
   * Single confident signal: color change only
   * ========================================= */
  .faq__item {
    padding-left: var(--space-5);
  }

  @media (min-width: 768px) {
    .faq__item {
      padding-left: var(--space-6);
    }
  }

  .faq__question {
    transition: color var(--duration-fast) var(--ease-out);
  }

  .faq__item:hover .faq__question {
    color: var(--color-accent);
  }

  /* =========================================
   * INVITATION SECTION
   * Clean, undecorated - whitespace establishes hierarchy
   * ========================================= */
  .invitation__content {
    /* Container for form alignment */
  }

  /* =========================================
   * STORY PULL QUOTE ENHANCEMENT
   * Left border accent with gradient
   * ========================================= */
  .story__pull {
    position: relative;
    border-radius: var(--radius-sm);
  }

  /* =========================================
   * ATMOSPHERE PARALLAX
   * Subtle parallax on scroll
   * ========================================= */
  .atmosphere__orb {
    will-change: transform;
  }

  /* =========================================
   * CTA FORM MICRO-INTERACTIONS
   * ========================================= */
  .cta--inline,
  .invitation__form {
    transition: transform var(--duration-normal) var(--ease-out);
  }

  .cta--inline:focus-within,
  .invitation__form:focus-within {
    transform: translateY(calc(-1 * var(--space-0-5)));
  }

  /* =========================================
   * REDUCED MOTION
   * ========================================= */
  @media (prefers-reduced-motion: reduce) {
    .atmosphere__orb {
      animation: none;
      opacity: 0.2;
    }

    [data-animate] {
      animation: none !important;
      opacity: 1 !important;
      transform: none !important;
      filter: none !important;
    }

    .story,
    .faq,
    .invitation,
    .faq__item {
      opacity: 1 !important;
      transform: none !important;
      transition: none !important;
    }

    .claude-terminal {
      transition: none !important;
    }
  }
</style>

<script>
  /**
   * Terminal Animation Orchestrator
   *
   * Creates an authentic Claude Code experience with:
   * - Realistic human typing speed (~65 WPM)
   * - "Thinking" indicator with cycling action words
   * - Proper pauses reflecting real LLM response times
   * - Auto-scroll as content grows
   *
   * Timing grounded in research:
   * - Human typing: 40-75 WPM avg (WordsRated 2024)
   * - Claude first token latency: 0.7-2s (AI benchmarks)
   * - Claude output: ~70 tokens/sec streaming
   */

  function initTerminalAnimation() {
    const terminal = document.querySelector('[data-terminal-animate]') as HTMLElement | null;
    if (!terminal || terminal.hasAttribute('data-animation-initialized')) return;

    terminal.setAttribute('data-animation-initialized', 'true');
    terminal.setAttribute('data-animation-ready', 'true'); // Signals CSS that JS is in control

    const contentArea = terminal.querySelector('.claude-terminal__content') as HTMLElement | null;

    // Check for reduced motion preference
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReducedMotion) {
      terminal.querySelectorAll('[data-beat], [data-reveal]').forEach(el => {
        el.classList.add('is-revealed');
      });
      return;
    }

    // Timing configuration grounded in real-world data
    const TIMING = {
      // User typing: more contemplative pace with human variance
      typewriterSpeed: 65,         // Slower, more deliberate
      typewriterVariance: 35,      // More human irregularity
      typewriterPunctuationPause: 100,
      typewriterStartDelay: 400,   // Enough for cursor to blink once
      cursorLingerTime: 200,

      // Thinking duration varies by task complexity
      thinkingComplexDuration: 1800,   // After complex audit request
      thinkingSimpleDuration: 1000,    // After simple "Fix them" command
      thinkingWordInterval: 1000,
      thinkingFadeOutDuration: 200,

      // Claude responses - snappy but readable
      claudeResponseDelay: 300,
      revealStagger: 200,
      toolRevealDelay: 350,
      postToolPause: 600,
      readingPause: 600,           // Pause after responses with data

      // Beat gaps - tighter for conversational momentum
      beatGap: 350,
      finalBeatGap: 400,

      // Wait for terminal's page entry animation - let headline land first
      pageEntryWait: 1200,
    };

    // Simplified action words - focused and context-appropriate
    const THINKING_WORDS = ['Thinking', 'Analyzing', 'Reviewing'];
    const WRITING_WORDS = ['Writing', 'Updating'];

    // Get all beats in order
    const beats = Array.from(terminal.querySelectorAll('[data-beat]'))
      .sort((a, b) => {
        const aNum = parseInt(a.getAttribute('data-beat') || '0', 10);
        const bNum = parseInt(b.getAttribute('data-beat') || '0', 10);
        return aNum - bNum;
      });

    // Debounced scroll - prevents jitter from rapid calls during typewriter
    let scrollTimeout: number | null = null;
    let lastScrollTarget = 0;

    function scrollToElement(element: Element, immediate = false) {
      if (!contentArea) return;

      const elementRect = element.getBoundingClientRect();
      const contentRect = contentArea.getBoundingClientRect();
      const elementBottom = elementRect.bottom - contentRect.top + contentArea.scrollTop;
      const visibleBottom = contentArea.scrollTop + contentArea.clientHeight;

      // Only scroll if element is below visible area
      if (elementBottom <= visibleBottom - 20) return;

      const targetScroll = elementBottom - contentArea.clientHeight + 40;
      const scrollDelta = Math.abs(targetScroll - contentArea.scrollTop);

      // Large jumps (>50px) use instant scroll, small use smooth
      const behavior = scrollDelta > 50 ? 'instant' : 'smooth';

      if (immediate) {
        contentArea.scrollTo({ top: targetScroll, behavior: behavior as ScrollBehavior });
        lastScrollTarget = targetScroll;
        return;
      }

      // Debounce rapid calls (50ms) - good for typewriter
      if (scrollTimeout !== null) {
        clearTimeout(scrollTimeout);
      }

      lastScrollTarget = targetScroll;
      scrollTimeout = window.setTimeout(() => {
        contentArea.scrollTo({ top: lastScrollTarget, behavior: behavior as ScrollBehavior });
        scrollTimeout = null;
      }, 50);
    }

    // Check and update overflow state for fade effect
    function updateOverflowState() {
      if (!contentArea) return;
      const hasOverflow = contentArea.scrollHeight > contentArea.clientHeight;
      const atBottom = contentArea.scrollTop + contentArea.clientHeight >= contentArea.scrollHeight - 10;

      terminal.classList.toggle('has-overflow', hasOverflow);
      terminal.classList.toggle('at-bottom', atBottom);
    }

    // Show thinking indicator with cycling words and fade-out
    function showThinking(thinkingId: string, words: string[]): { stop: () => Promise<void> } {
      const thinkingEl = terminal.querySelector(`[data-thinking="${thinkingId}"]`) as HTMLElement | null;
      if (!thinkingEl) return { stop: () => Promise.resolve() };

      const textEl = thinkingEl.querySelector('.claude-terminal__thinking-text');
      let wordIndex = 0;
      let intervalId: number;

      thinkingEl.classList.add('is-active');
      scrollToElement(thinkingEl, true);

      // Cycle through words at slower pace
      intervalId = window.setInterval(() => {
        wordIndex = (wordIndex + 1) % words.length;
        if (textEl) textEl.textContent = words[wordIndex];
      }, TIMING.thinkingWordInterval);

      return {
        stop: () => {
          clearInterval(intervalId);
          // Fade out gracefully
          thinkingEl.classList.add('is-fading');
          return new Promise<void>((resolve) => {
            setTimeout(() => {
              thinkingEl.classList.remove('is-active', 'is-fading');
              resolve();
            }, TIMING.thinkingFadeOutDuration);
          });
        }
      };
    }

    // Typewriter effect with realistic human variance
    function typewrite(element: Element, preStoredText?: string): Promise<void> {
      return new Promise((resolve) => {
        const text = preStoredText || element.textContent || '';
        const prompt = element.closest('[data-beat]')?.querySelector('.claude-terminal__prompt');

        element.textContent = '';
        const cursor = document.createElement('span');
        cursor.className = 'claude-terminal__cursor';
        element.appendChild(cursor);

        let charIndex = 0;

        function typeNextChar() {
          if (charIndex < text.length) {
            const char = document.createTextNode(text[charIndex]);
            element.insertBefore(char, cursor);
            charIndex++;

            // Only scroll every 8 characters to reduce jitter
            if (charIndex % 8 === 0 || charIndex === text.length) {
              scrollToElement(element);
            }

            // Realistic timing variance
            const baseDelay = TIMING.typewriterSpeed;
            const variance = (Math.random() * TIMING.typewriterVariance * 2) - TIMING.typewriterVariance;
            const punctuation = [',', '.', '?', '!', ';', ':'];
            const extraPause = punctuation.includes(text[charIndex - 1]) ? TIMING.typewriterPunctuationPause : 0;

            // Occasional brief hesitation (human thinking)
            const hesitation = Math.random() < 0.03 ? 150 : 0;

            setTimeout(typeNextChar, baseDelay + variance + extraPause + hesitation);
          } else {
            setTimeout(() => {
              cursor.classList.add('claude-terminal__cursor--hidden');
              if (prompt) prompt.classList.add('is-complete');
              setTimeout(() => {
                cursor.remove();
                resolve();
              }, 100);
            }, TIMING.cursorLingerTime);
          }
        }

        typeNextChar();
      });
    }

    // Reveal Claude response elements with proper pacing
    function revealClaudeResponse(beat: Element): Promise<void> {
      return new Promise((resolve) => {
        const revealElements = beat.querySelectorAll('[data-reveal]');
        let delay = 0;
        let hasToolCall = false;

        revealElements.forEach((el) => {
          const type = el.getAttribute('data-reveal');
          const isToolCall = type === 'tool';

          if (isToolCall) {
            delay += TIMING.toolRevealDelay;
            hasToolCall = true;
          }

          setTimeout(() => {
            el.classList.add('is-revealed');
            scrollToElement(el, true); // immediate scroll for reveals
            updateOverflowState();
          }, delay);

          delay += TIMING.revealStagger;

          // Simulate "processing" time after tool calls
          if (isToolCall) {
            delay += TIMING.postToolPause;
          }
        });

        // Add reading pause after responses with data (tool calls)
        if (hasToolCall) {
          delay += TIMING.readingPause;
        }

        setTimeout(resolve, delay + 150);
      });
    }

    // Main animation sequence
    async function runAnimation() {
      // Wait for page entry animation to complete before starting
      await new Promise(r => setTimeout(r, TIMING.pageEntryWait));

      terminal.setAttribute('data-animation-started', 'true');

      // Reset scroll to top when animation begins
      if (contentArea) {
        contentArea.scrollTop = 0;
      }

      for (let i = 0; i < beats.length; i++) {
        const beat = beats[i];
        const beatNum = beat.getAttribute('data-beat');
        const isUserBeat = beat.classList.contains('claude-terminal__message--user');
        const typewriterEl = beat.querySelector('[data-typewriter]') as HTMLElement | null;
        const isLastBeat = i === beats.length - 1;

        // Check if previous beat was also a Claude message (consecutive Claude messages)
        const prevBeat = i > 0 ? beats[i - 1] : null;
        const prevWasClaude = prevBeat && prevBeat.classList.contains('claude-terminal__message--claude');
        const isClaudeBeat = beat.classList.contains('claude-terminal__message--claude');

        if (isUserBeat && typewriterEl) {
          // Store text and clear BEFORE revealing to prevent flash
          const storedText = typewriterEl.textContent || '';
          typewriterEl.textContent = '';

          // Add blinking cursor immediately for anticipation
          const earlyCursor = document.createElement('span');
          earlyCursor.className = 'claude-terminal__cursor';
          typewriterEl.appendChild(earlyCursor);

          // User message: reveal container with cursor visible
          beat.classList.add('is-revealed');
          scrollToElement(beat, true);

          // Brief pause with cursor blinking creates anticipation
          await new Promise(r => setTimeout(r, TIMING.typewriterStartDelay));

          // Remove early cursor before typewrite adds its own
          earlyCursor.remove();
          await typewrite(typewriterEl, storedText);

          // After user types, show thinking indicator for next Claude response
          const nextThinkingId = beatNum;
          const thinkingEl = terminal.querySelector(`[data-thinking="${nextThinkingId}"]`);
          if (thinkingEl) {
            const words = thinkingEl.querySelector('.claude-terminal__thinking-text')?.textContent === 'Writing'
              ? WRITING_WORDS
              : THINKING_WORDS;
            const thinking = showThinking(nextThinkingId, words);
            // Vary thinking duration by task complexity
            // Beat 1 (audit request) = complex, Beat 3 (fix them) = simple
            const thinkingDuration = beatNum === '1'
              ? TIMING.thinkingComplexDuration
              : TIMING.thinkingSimpleDuration;
            await new Promise(r => setTimeout(r, thinkingDuration));
            await thinking.stop(); // await the fade-out
          }
        } else {
          // Check for thinking indicator before consecutive Claude messages
          if (isClaudeBeat && prevWasClaude && beatNum) {
            const prevBeatNum = parseInt(beatNum, 10) - 1;
            const thinkingEl = terminal.querySelector(`[data-thinking="${prevBeatNum}"]`);
            if (thinkingEl) {
              const thinking = showThinking(String(prevBeatNum), THINKING_WORDS);
              await new Promise(r => setTimeout(r, TIMING.thinkingSimpleDuration));
              await thinking.stop();
            }
          }

          // Claude message: staggered reveal
          await new Promise(r => setTimeout(r, TIMING.claudeResponseDelay));
          beat.classList.add('is-revealed');
          scrollToElement(beat, true);
          await revealClaudeResponse(beat);
        }

        // Gap before next beat
        const gap = isLastBeat ? TIMING.finalBeatGap : TIMING.beatGap;
        await new Promise(r => setTimeout(r, gap));
      }

      updateOverflowState();
    }

    // Set up scroll listener for fade effect
    if (contentArea) {
      contentArea.addEventListener('scroll', updateOverflowState);
    }

    // Trigger animation when terminal enters viewport
    const observer = new IntersectionObserver(
      (entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            runAnimation(); // pageEntryWait handles the delay
            observer.disconnect();
          }
        });
      },
      { threshold: 0.2 } // Trigger slightly earlier
    );

    observer.observe(terminal);
  }

  // Initialize on DOM ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initTerminalAnimation);
  } else {
    initTerminalAnimation();
  }

  // Re-initialize on Astro page transitions
  document.addEventListener('astro:page-load', initTerminalAnimation);

  /**
   * Scroll-Triggered Reveal Animations
   * Uses IntersectionObserver for performance
   */
  function initScrollReveal() {
    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReducedMotion) {
      // Show everything immediately
      document.querySelectorAll('.story, .faq, .invitation').forEach(el => {
        el.classList.add('is-visible');
      });
      return;
    }

    const observerOptions = {
      root: null,
      rootMargin: '0px 0px -10% 0px', // Trigger slightly before fully in view
      threshold: 0.1
    };

    const revealObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          revealObserver.unobserve(entry.target);
        }
      });
    }, observerOptions);

    // Observe all reveal targets
    document.querySelectorAll('.story, .faq, .invitation').forEach(el => {
      revealObserver.observe(el);
    });
  }

  /**
   * Subtle Parallax for Atmosphere Orb
   * Moves opposite to scroll for depth
   */
  function initAtmosphereParallax() {
    const orb = document.querySelector('.atmosphere__orb') as HTMLElement | null;
    if (!orb) return;

    const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReducedMotion) return;

    let ticking = false;

    function updateParallax() {
      const scrollY = window.scrollY;
      // Subtle parallax: move up as user scrolls down (0.05x speed)
      const parallaxY = scrollY * 0.05;
      orb.style.transform = `translateX(-50%) translateY(${-parallaxY}px)`;
      ticking = false;
    }

    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(updateParallax);
        ticking = true;
      }
    }, { passive: true });
  }

  // Initialize scroll effects
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      initScrollReveal();
      initAtmosphereParallax();
    });
  } else {
    initScrollReveal();
    initAtmosphereParallax();
  }

  // Re-initialize on Astro page transitions
  document.addEventListener('astro:page-load', () => {
    initScrollReveal();
    initAtmosphereParallax();
  });
</script>
