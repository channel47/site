---
/**
 * Ecosystem Page
 * Browsable plugin listing, free assets, contribution teaser.
 *
 * Density: LOW (hero) → MEDIUM (Season 01) → MEDIUM (free assets) →
 *          LOW (contribute) → MEDIUM (signup)
 */
import BaseLayout from '../layouts/BaseLayout.astro';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';
import EmailSignup from '../components/EmailSignup.astro';

const skills = [
  { idx: '001', name: 'Platform Setup', desc: 'Connect Google Ads and Bing Ads. Verify account access.', tier: 1 },
  { idx: '002', name: 'Morning Brief', desc: 'Daily cross-platform health summary with anomaly detection.', tier: 1 },
  { idx: '003', name: 'Waste Detector', desc: 'Find spend leaks, quantify in dollars, auto-remediate.', tier: 2 },
  { idx: '004', name: 'Search Term Verdict', desc: 'Classify terms: NEGATE, PROMOTE, INVESTIGATE, or KEEP.', tier: 2 },
  { idx: '005', name: 'PMax Decoder', desc: 'Crack open Performance Max — search terms, channels, assets.', tier: 2 },
];
---

<BaseLayout
  title="Ecosystem — Channel 47"
  description="Browse the Channel 47 plugin ecosystem. Install plugins for Claude Code and Cowork. Season 01: Media Buyer."
>
  <main class="pg">

    <!-- =======================================
         HERO (LOW density)
         ======================================= -->
    <section class="hero" data-section="hero">
      <Nav currentPath="/ecosystem" />
      <div class="hero__content">
        <div class="hero__bar" aria-hidden="true"></div>
        <p class="label">THE ECOSYSTEM</p>
        <h1 class="hero__headline">One plugin.<br />Everything your role needs.</h1>
        <p class="hero__sub">
          A plugin bundles the skills, API connections, and safety layers a
          profession needs. Install it and go. Or take one apart and build
          your own.
        </p>
      </div>
    </section>

    <!-- =======================================
         SEASON 01: MEDIA BUYER (MEDIUM density)
         ======================================= -->
    <section class="eco-plugin" data-section="eco-plugin">
      <div class="eco-plugin__content">
        <p class="label">SEASON 01</p>

        <!-- Plugin card — visual container with presence -->
        <div class="eco-card">
          <div class="eco-card__header">
            <div class="eco-card__bar" aria-hidden="true"></div>
            <div class="eco-card__meta">
              <span class="eco-card__title">Media Buyer</span>
              <span class="eco-card__badge">5 SKILLS</span>
              <span class="eco-card__badge">2 PLATFORMS</span>
            </div>
            <p class="eco-card__desc">
              Everything a paid-search practitioner needs. Google Ads, Bing Ads,
              search term analysis, anomaly detection, spend analysis. Built from
              managing 25+ accounts.
            </p>
          </div>

          <div class="eco-card__skills">
            {skills.map((skill) => (
              <div class="eco-card__skill">
                <span class="eco-card__skill-idx" aria-hidden="true">{skill.idx}</span>
                <div class="eco-card__skill-detail">
                  <div class="eco-card__skill-row">
                    <span class="eco-card__skill-name">{skill.name}</span>
                    <span class:list={['eco-card__skill-tier', skill.tier === 2 && 'eco-card__skill-tier--2']}>
                      T{skill.tier}
                    </span>
                  </div>
                  <span class="eco-card__skill-desc">{skill.desc}</span>
                </div>
              </div>
            ))}
          </div>

          <div class="eco-card__install">
            <p class="eco-card__install-label">INSTALL</p>
            <div class="eco-card__cmds">
              <div class="eco-card__cmd-group">
                <span class="eco-card__cmd-platform">Claude Code</span>
                <code class="eco-card__cmd">/plugin marketplace add channel47/channel47</code>
                <code class="eco-card__cmd">/plugin install media-buyer@channel47</code>
              </div>
              <div class="eco-card__cmd-group">
                <span class="eco-card__cmd-platform">Cowork</span>
                <code class="eco-card__cmd">/plugins → Add marketplace → channel47/channel47 → media-buyer</code>
              </div>
            </div>
          </div>

          <div class="eco-card__footer">
            <a class="eco-card__github" href="https://github.com/channel47/channel47" target="_blank" rel="noopener">View on GitHub &rarr;</a>
          </div>
        </div>
      </div>
    </section>

    <!-- =======================================
         FREE ASSETS (MEDIUM density)
         ======================================= -->
    <section class="eco-assets" data-section="eco-assets">
      <div class="eco-assets__content">
        <p class="label">FREE ASSETS</p>
        <h2 class="eco-assets__title">Templates to get started.</h2>
        <p class="eco-assets__sub">
          Downloadable skill templates for building your own. Start from a
          working example and remix.
        </p>
        <div class="eco-assets__grid">
          <a href="/skills/skill-template.md" download class="eco-asset" data-animate="fade-up" data-stagger="1">
            <span class="eco-asset__icon" aria-hidden="true">001</span>
            <span class="eco-asset__name">Skill Template</span>
            <span class="eco-asset__desc">Minimal SKILL.md starter with frontmatter and section scaffolding.</span>
            <span class="eco-asset__action">Download .md</span>
          </a>
          <a href="/skills/plugin-scaffold.md" download class="eco-asset" data-animate="fade-up" data-stagger="2">
            <span class="eco-asset__icon" aria-hidden="true">002</span>
            <span class="eco-asset__name">Plugin Scaffold</span>
            <span class="eco-asset__desc">Directory structure and plugin.json template for new plugins.</span>
            <span class="eco-asset__action">Download .md</span>
          </a>
        </div>
      </div>
    </section>

    <!-- =======================================
         CONTRIBUTE (LOW density)
         ======================================= -->
    <section class="eco-contribute" data-section="eco-contribute">
      <div class="eco-contribute__content">
        <div class="accent-bar" aria-hidden="true"></div>
        <p class="label">CONTRIBUTE</p>
        <h2 class="eco-contribute__title">Your expertise could be next.</h2>
        <p class="eco-contribute__body">
          Every skill in the ecosystem was built by a practitioner. Submit
          markdown — that's Tier 1. Add a script and that's Tier 2. Either
          way, your name is on it. Contributing is the fastest path from
          "I use AI tools" to "I build them."
        </p>
        <a class="eco-contribute__link" href="https://github.com/channel47/channel47/blob/main/CONTRIBUTING.md" target="_blank" rel="noopener">
          Contributing guide on GitHub &rarr;
        </a>
      </div>
    </section>

    <!-- =======================================
         SIGNUP (MEDIUM density)
         ======================================= -->
    <section class="eco-signup" data-section="eco-signup">
      <div class="eco-signup__content">
        <p class="label">STAY IN THE LOOP</p>
        <h2 class="eco-signup__title">New skills, new plugins, new seasons.</h2>
        <p class="eco-signup__micro">No spam. Unsubscribe anytime.</p>
        <EmailSignup placeholder="you@domain.com" tag="ecosystem" submitText="Subscribe" />
      </div>
    </section>

    <Footer />
  </main>

  <script>
    import { initPageMotion } from '../scripts/page-motion';
    initPageMotion();
  </script>
</BaseLayout>

<style is:global>
  @import '../styles/sections.css';
</style>

<style>
  /* ---- Season 01 Plugin (MEDIUM density) ---- */
  .eco-plugin {
    padding: clamp(60px, 10vh, 100px) clamp(24px, 5vw, 64px);
    opacity: 0;
    transform: translateY(12px);
    transition: opacity 400ms var(--ease-out),
                transform 400ms var(--ease-out);
  }

  .eco-plugin.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .eco-plugin__content > .label {
    margin-bottom: 16px;
  }

  /* ---- Plugin Card — bordered container with sections ---- */
  .eco-card {
    border: 1px solid var(--color-border);
    border-radius: 2px;
    background: var(--color-bg-elevated);
    max-width: 640px;
    overflow: hidden;
  }

  .eco-card__header {
    padding: 24px 24px 20px;
    border-bottom: 1px solid var(--color-border);
  }

  .eco-card__bar {
    width: 0;
    height: 2px;
    background-color: var(--color-accent);
    margin-bottom: 16px;
  }

  .eco-plugin.is-visible .eco-card__bar {
    animation: drawH 400ms var(--ease-out) 300ms forwards;
  }

  .eco-card__meta {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 10px;
  }

  .eco-card__title {
    font-family: var(--font-display);
    font-size: clamp(1.25rem, 2.5vw, 1.75rem);
    font-weight: 600;
    color: var(--color-fg-emphasis);
    letter-spacing: -0.02em;
  }

  .eco-card__badge {
    font-family: var(--font-mono);
    font-size: 9px;
    font-weight: 600;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    padding: 2px 8px;
    border-radius: 2px;
    background: var(--color-bg-surface);
    color: var(--color-fg-muted);
  }

  .eco-card__desc {
    font-family: var(--font-mono);
    font-size: 13px;
    line-height: 1.7;
    color: var(--color-fg-secondary);
    letter-spacing: 0.02em;
    max-width: 520px;
  }

  /* Skills list inside card */
  .eco-card__skills {
    padding: 0 24px;
  }

  .eco-card__skill {
    display: grid;
    grid-template-columns: 28px 1fr;
    column-gap: 12px;
    padding: 12px 0;
    border-bottom: 1px solid var(--color-border);
  }

  .eco-card__skill:last-child {
    border-bottom: none;
  }

  .eco-card__skill-idx {
    font-family: var(--font-mono);
    font-size: 11px;
    color: var(--color-border);
    letter-spacing: 0.1em;
    padding-top: 1px;
  }

  .eco-card__skill-detail {
    display: grid;
    gap: 2px;
  }

  .eco-card__skill-row {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .eco-card__skill-name {
    font-family: var(--font-mono);
    font-size: 13px;
    font-weight: 600;
    color: var(--color-fg);
    letter-spacing: 0.02em;
  }

  .eco-card__skill-tier {
    font-family: var(--font-mono);
    font-size: 9px;
    font-weight: 600;
    letter-spacing: 0.12em;
    padding: 1px 5px;
    border-radius: 2px;
    background: var(--color-bg-surface);
    color: var(--color-fg-muted);
  }

  .eco-card__skill-tier--2 {
    background: var(--color-accent-subtle);
    color: var(--color-accent);
  }

  .eco-card__skill-desc {
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--color-fg-muted);
    letter-spacing: 0.02em;
    line-height: 1.5;
  }

  /* Install section inside card */
  .eco-card__install {
    padding: 20px 24px;
    border-top: 1px solid var(--color-border);
    background: var(--color-bg);
  }

  .eco-card__install-label {
    font-family: var(--font-mono);
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 0.15em;
    text-transform: uppercase;
    color: var(--color-fg-muted);
    margin-bottom: 12px;
  }

  .eco-card__cmds {
    display: grid;
    gap: 14px;
  }

  .eco-card__cmd-group {
    display: grid;
    gap: 4px;
  }

  .eco-card__cmd-platform {
    font-family: var(--font-mono);
    font-size: 11px;
    font-weight: 600;
    color: var(--color-fg-muted);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-bottom: 2px;
  }

  .eco-card__cmd {
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--color-fg);
    background: var(--color-bg-elevated);
    padding: 8px 12px;
    border-radius: 2px;
    display: block;
    letter-spacing: 0.02em;
    user-select: all;
    border: 1px solid var(--color-border);
  }

  /* Card footer */
  .eco-card__footer {
    padding: 16px 24px;
    border-top: 1px solid var(--color-border);
  }

  .eco-card__github {
    font-family: var(--font-mono);
    font-size: 11px;
    font-weight: 600;
    letter-spacing: var(--tracking-widest);
    text-transform: uppercase;
    color: var(--color-fg-muted);
    transition: color 150ms var(--ease-sharp);
  }

  .eco-card__github:hover {
    color: var(--color-accent);
    text-decoration: none;
  }

  /* ---- Free Assets (MEDIUM density) ---- */
  .eco-assets {
    padding: clamp(60px, 10vh, 100px) clamp(24px, 5vw, 64px);
    opacity: 0;
    transform: translateY(12px);
    transition: opacity 400ms var(--ease-out),
                transform 400ms var(--ease-out);
  }

  .eco-assets.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .eco-assets__content .label {
    margin-bottom: 8px;
  }

  .eco-assets__title {
    font-family: var(--font-display);
    font-size: clamp(1.5rem, 3vw, 2rem);
    font-weight: 600;
    letter-spacing: -0.03em;
    line-height: 1.1;
    color: var(--color-fg-emphasis);
    margin-bottom: 8px;
  }

  .eco-assets__sub {
    font-family: var(--font-mono);
    font-size: 14px;
    line-height: 1.7;
    color: var(--color-fg-secondary);
    max-width: 480px;
    margin-bottom: 24px;
  }

  .eco-assets__grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 16px;
    max-width: 672px;
  }

  .eco-asset {
    display: grid;
    grid-template-columns: 32px 1fr;
    grid-template-rows: auto auto auto;
    column-gap: 12px;
    padding: 16px;
    border: 1px solid var(--color-border);
    border-radius: 2px;
    text-decoration: none;
    color: inherit;
    transition:
      border-color var(--duration-fast) var(--ease-out),
      background-color var(--duration-fast) var(--ease-out);
  }

  .eco-asset:hover {
    border-color: var(--color-accent);
    background: var(--color-bg-elevated);
    text-decoration: none;
  }

  .eco-asset__icon {
    grid-row: 1 / -1;
    font-family: var(--font-mono);
    font-size: 11px;
    color: var(--color-border);
    letter-spacing: 0.1em;
    padding-top: 2px;
  }

  .eco-asset__name {
    font-family: var(--font-mono);
    font-size: 14px;
    font-weight: 600;
    color: var(--color-fg);
    letter-spacing: 0.02em;
  }

  .eco-asset__desc {
    font-family: var(--font-mono);
    font-size: 12px;
    color: var(--color-fg-muted);
    line-height: 1.5;
    margin-top: 4px;
  }

  .eco-asset__action {
    font-family: var(--font-mono);
    font-size: 11px;
    font-weight: 600;
    color: var(--color-accent);
    letter-spacing: 0.1em;
    text-transform: uppercase;
    margin-top: 8px;
  }

  /* ---- Contribute (LOW density) ---- */
  .eco-contribute {
    padding: clamp(80px, 12vh, 120px) clamp(24px, 5vw, 64px);
    border-top: 1px solid var(--color-border);
    opacity: 0;
    transform: translateY(12px);
    transition: opacity 400ms var(--ease-out),
                transform 400ms var(--ease-out);
  }

  .eco-contribute.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .eco-contribute__content .accent-bar {
    width: 0;
  }

  .eco-contribute__content .label {
    margin-top: 20px;
    margin-bottom: 16px;
  }

  .eco-contribute__title {
    font-family: var(--font-display);
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    font-weight: 600;
    letter-spacing: -0.03em;
    line-height: 1.1;
    color: var(--color-fg-emphasis);
    margin-bottom: 16px;
  }

  .eco-contribute__body {
    font-family: var(--font-mono);
    font-size: 14px;
    line-height: 1.7;
    color: var(--color-fg-secondary);
    max-width: 540px;
    margin-bottom: 20px;
    letter-spacing: 0.02em;
  }

  .eco-contribute__link {
    font-family: var(--font-mono);
    font-size: 11px;
    font-weight: 600;
    letter-spacing: var(--tracking-widest);
    text-transform: uppercase;
    color: var(--color-accent);
    transition: color 150ms var(--ease-sharp);
  }

  .eco-contribute__link:hover {
    color: var(--color-fg);
    text-decoration: none;
  }

  /* ---- Signup (MEDIUM density) ---- */
  .eco-signup {
    padding: clamp(60px, 10vh, 100px) clamp(24px, 5vw, 64px);
    border-top: 1px solid var(--color-border);
    opacity: 0;
    transform: translateY(12px);
    transition: opacity 400ms var(--ease-out),
                transform 400ms var(--ease-out);
  }

  .eco-signup.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .eco-signup__content .label {
    margin-bottom: 8px;
  }

  .eco-signup__title {
    font-family: var(--font-display);
    font-size: clamp(1.5rem, 3vw, 2rem);
    font-weight: 600;
    letter-spacing: -0.03em;
    line-height: 1.1;
    color: var(--color-fg-emphasis);
    margin-bottom: 12px;
  }

  .eco-signup__micro {
    font-family: var(--font-mono);
    font-size: 11px;
    letter-spacing: 0.1em;
    color: var(--color-fg-muted);
    margin-bottom: 16px;
    text-transform: uppercase;
  }

  /* ---- Reduced Motion ---- */
  @media (prefers-reduced-motion: reduce) {
    .eco-plugin,
    .eco-plugin__cta,
    .eco-asset,
    .eco-contribute__link,
    .cta__action,
    .cta__action::after {
      transition: none !important;
    }

    .eco-plugin {
      opacity: 1 !important;
    }
  }
</style>
