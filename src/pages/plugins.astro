---
/**
 * Plugins Directory
 * ch47 design system — shared section styles + page-specific overrides.
 *
 * Density: LOW (hero) → HIGH (stats) → MEDIUM (plugin card) →
 *          HIGH rupture (light inversion, terminal log) → MEDIUM (roadmap) → LOW (cta void)
 */
import BaseLayout from '../layouts/BaseLayout.astro';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';
---

<BaseLayout
  title="Plugins — channel47"
  description="Claude Code plugins built by a media buyer, not a prompt engineer. Tools that do real work on real accounts."
>
  <main class="pg">
    <!-- =======================================
         ACT 1: HERO (LOW density)
         Sparse. Commanding. One thought.
         ======================================= -->
    <section class="hero" data-section="hero">
      <Nav currentPath="/plugins" />

      <div class="hero__content">
        <div class="hero__bar" aria-hidden="true"></div>
        <p class="label">PLUGINS / DIRECTORY</p>
        <h1 class="hero__headline" id="hero-headline">
          Tools that do<br />the work.
        </h1>
        <p class="hero__sub">
          Claude Code plugins built from managing real ad spend on real accounts. Not demos. Not proofs of concept. Two tools — one ships campaigns from a URL with zero setup, the other plugs into the Google Ads API and does the Monday morning checklist before Monday morning.
        </p>
      </div>
    </section>

    <!-- =======================================
         ACT 2: STATS BAR (HIGH density)
         Dense, quiet credibility strip. Scale-in entrance.
         ======================================= -->
    <section class="stats" data-section="stats">
      <div class="stats__item" data-animate="fade-up" data-stagger="1">
        <span class="stats__value">2</span>
        <span class="stats__label">PLUGINS SHIPPED</span>
      </div>
      <div class="stats__pipe" aria-hidden="true"></div>
      <div class="stats__item" data-animate="fade-up" data-stagger="3">
        <span class="stats__value">25+</span>
        <span class="stats__label">ACCOUNTS MANAGED</span>
      </div>
      <div class="stats__pipe" aria-hidden="true"></div>
      <div class="stats__item" data-animate="fade-up" data-stagger="5">
        <span class="stats__value">v3.0.0</span>
        <span class="stats__label">LATEST VERSION</span>
      </div>
      <div class="stats__pipe" aria-hidden="true"></div>
      <div class="stats__item" data-animate="fade-up" data-stagger="7">
        <span class="stats__value">MIT</span>
        <span class="stats__label">LICENSE</span>
      </div>
    </section>

    <!-- =======================================
         ACT 3: PLUGIN CARD (MEDIUM density)
         The main event. Asymmetric two-panel.
         ======================================= -->
    <section class="plugins" data-section="plugins">
      <!-- MEDIA BUYER — v3.0.0 (featured) -->
      <div class="plugins__grid">
        <div class="plugins__card plugins__card--primary">
          <div class="plugins__card-bar" aria-hidden="true"></div>
          <span class="label">047.MEDIA-BUYER</span>
          <h2 class="plugins__title">Media Buyer</h2>
          <p class="plugins__version">v3.0.0</p>
          <p class="plugins__desc">
            Two high-leverage skills for media buyers. Build a complete Google Search campaign from a landing page URL. Generate creative variations of winning ads at three divergence levels. No API keys. No MCP servers. No setup.
          </p>
          <div class="plugins__tags">
            <span class="tag">google-ads</span>
            <span class="tag">search-campaign</span>
            <span class="tag">ad-creative</span>
            <span class="tag">media-buying</span>
          </div>
          <div class="plugins__meta">
            <span>Jackson Dean</span>
            <span class="meta__pipe" aria-hidden="true"></span>
            <span>MIT License</span>
            <span class="meta__pipe" aria-hidden="true"></span>
            <a href="https://github.com/channel47/media-buyer" class="plugins__link">GitHub →</a>
          </div>
        </div>

        <div class="plugins__card plugins__card--secondary">
          <span class="label">STATUS</span>
          <div class="plugins__status">
            <div class="status__row">
              <span class="status__dot status__dot--active"></span>
              <span class="status__text">Search Campaign Skill</span>
              <span class="status__val">Shipped</span>
            </div>
            <div class="status__row">
              <span class="status__dot status__dot--active"></span>
              <span class="status__text">Creative Variants Skill</span>
              <span class="status__val">Shipped</span>
            </div>
            <div class="status__row">
              <span class="status__dot status__dot--active"></span>
              <span class="status__text">Zero Setup Required</span>
              <span class="status__val">No APIs</span>
            </div>
          </div>
          <div class="plugins__install">
            <span class="label" style="margin-bottom: 8px;">INSTALL</span>
            <code class="plugins__cmd">git clone channel47/media-buyer</code>
          </div>
        </div>
      </div>

      <!-- ADS — v2.5.0 (full toolkit) -->
      <div class="plugins__grid">
        <div class="plugins__card plugins__card--primary">
          <div class="plugins__card-bar" aria-hidden="true"></div>
          <span class="label">047.ADS</span>
          <h2 class="plugins__title">Google Ads</h2>
          <p class="plugins__version">v2.5.0</p>
          <p class="plugins__desc">
            The full toolkit. Campaign creation and optimization with PMax, Search, and Audit skills plus three research agents. Connects to the Google Ads API via MCP, runs GAQL queries, and does the Monday morning checklist before Monday morning.
          </p>
          <div class="plugins__tags">
            <span class="tag">google-ads</span>
            <span class="tag">mcp</span>
            <span class="tag">gaql</span>
          </div>
          <div class="plugins__meta">
            <span>Jackson</span>
            <span class="meta__pipe" aria-hidden="true"></span>
            <span>MIT License</span>
            <span class="meta__pipe" aria-hidden="true"></span>
            <a href="https://github.com/channel47/channel47" class="plugins__link">GitHub →</a>
          </div>
        </div>

        <div class="plugins__card plugins__card--secondary">
          <span class="label">STATUS</span>
          <div class="plugins__status">
            <div class="status__row">
              <span class="status__dot status__dot--active"></span>
              <span class="status__text">MCP Server</span>
              <span class="status__val">Connected</span>
            </div>
            <div class="status__row">
              <span class="status__dot status__dot--active"></span>
              <span class="status__text">Search Skills</span>
              <span class="status__val">Shipped</span>
            </div>
            <div class="status__row">
              <span class="status__dot status__dot--active"></span>
              <span class="status__text">PMax Skills</span>
              <span class="status__val">Shipped</span>
            </div>
            <div class="status__row">
              <span class="status__dot status__dot--active"></span>
              <span class="status__text">Audit Skills</span>
              <span class="status__val">Shipped</span>
            </div>
            <div class="status__row">
              <span class="status__dot status__dot--building"></span>
              <span class="status__text">Agent Loop</span>
              <span class="status__val status__val--building">Building</span>
            </div>
          </div>
          <div class="plugins__install">
            <span class="label" style="margin-bottom: 8px;">INSTALL</span>
            <code class="plugins__cmd">git clone channel47/channel47</code>
          </div>
        </div>
      </div>
    </section>

    <!-- =======================================
         ACT 4: RUPTURE (Light inversion, HIGH density)
         Surface flip + density shift. Terminal build log.
         Dense operational readout contrasts LOW hero above.
         ======================================= -->
    <section class="rupture" data-section="rupture">
      <div class="rupture__bar" aria-hidden="true"></div>
      <div class="rupture__terminal">
        <span class="label rupture__label">047 / BUILD LOG</span>
        <div class="rupture__log">
          <div class="rupture__entry">
            <span class="rupture__ts">2024.11</span>
            <span class="rupture__msg">Script catches $3K/mo negative keyword gap across 2 accounts</span>
          </div>
          <div class="rupture__entry">
            <span class="rupture__ts">2025.01</span>
            <span class="rupture__msg">Plugin v1 ships — Search, PMax, Audit skills in production</span>
          </div>
          <div class="rupture__entry">
            <span class="rupture__ts">2025.03</span>
            <span class="rupture__msg">MCP server connected. GAQL queries from Claude Code.</span>
          </div>
          <div class="rupture__entry">
            <span class="rupture__ts">2025.06</span>
            <span class="rupture__msg">Open sourced. MIT license. Running on 25+ accounts.</span>
          </div>
          <div class="rupture__entry">
            <span class="rupture__ts">2026.02</span>
            <span class="rupture__msg">media-buyer v3.0 ships — two skills, zero setup, no API keys</span>
          </div>
          <div class="rupture__entry rupture__entry--now">
            <span class="rupture__ts">NOW</span>
            <span class="rupture__msg">Agent loop: audit → decide → execute → report</span>
          </div>
        </div>
        <p class="rupture__footnote">
          Built by a media buyer who manages real ad spend. Not a demo. Not a proof of concept.
        </p>
      </div>
    </section>

    <!-- =======================================
         ACT 5: COMING NEXT (MEDIUM density)
         Terminal-style sequential reveal.
         ======================================= -->
    <section class="roadmap" data-section="roadmap">
      <div class="roadmap__header">
        <div class="accent-bar" aria-hidden="true"></div>
        <span class="label">ROADMAP</span>
        <h2 class="roadmap__title">What's next</h2>
      </div>
      <div class="roadmap__list" id="roadmap-list">
        <div class="roadmap__item">
          <span class="roadmap__idx">001</span>
          <span class="roadmap__text">Full agent loop (audit → decide → execute → report)</span>
          <span class="roadmap__status roadmap__status--active">IN PROGRESS</span>
        </div>
        <div class="roadmap__item">
          <span class="roadmap__idx">002</span>
          <span class="roadmap__text">Multi-account MCC scanning</span>
          <span class="roadmap__status">PLANNED</span>
        </div>
        <div class="roadmap__item">
          <span class="roadmap__idx">003</span>
          <span class="roadmap__text">Automated search term reports + negative keyword builds</span>
          <span class="roadmap__status">PLANNED</span>
        </div>
        <div class="roadmap__item">
          <span class="roadmap__idx">004</span>
          <span class="roadmap__text">Pacing alerts and budget guardrails</span>
          <span class="roadmap__status">PLANNED</span>
        </div>
        <div class="roadmap__item">
          <span class="roadmap__idx">005</span>
          <span class="roadmap__text">More plugins. Different domains. Same approach.</span>
          <span class="roadmap__status">SOMEDAY</span>
        </div>
      </div>
    </section>

    <!-- =======================================
         ACT 6: CTA (LOW density, The Void)
         One element. Maximum space.
         ======================================= -->
    <section class="cta" data-section="cta">
      <p class="label">TRANSMITTING</p>
      <a href="/#signup" class="cta__link">Get the build notes</a>
      <p class="cta__sub">Short emails when something real ships.</p>
    </section>

    <!-- Footer -->
    <Footer />
  </main>

  <!-- =======================================
       MOTION: Scroll reveals + Hero sequence + Glitch + Roadmap
       ======================================= -->
  <script>
    import { initPageMotion } from '../scripts/page-motion';

    initPageMotion({
      reducedMotionExtras() {
        document.querySelectorAll('.roadmap__item').forEach(el => el.classList.add('is-visible'));
      },
      onReady() {
        initRoadmapReveal();
      },
    });

    /** Sequential reveal for roadmap items when the section scrolls in. */
    function initRoadmapReveal(): void {
      const roadmapSection = document.querySelector('[data-section="roadmap"]');
      const roadmapItems = document.querySelectorAll('.roadmap__item');

      if (!roadmapSection || !roadmapItems.length) return;

      const observer = new IntersectionObserver(
        ([entry]) => {
          if (!entry.isIntersecting) return;
          observer.disconnect();

          let i = 0;
          function revealNext(): void {
            if (i >= roadmapItems.length) return;
            roadmapItems[i].classList.add('is-visible');
            i++;
            setTimeout(revealNext, 120 + Math.random() * 80);
          }
          setTimeout(revealNext, 400);
        },
        { threshold: 0.3 },
      );

      observer.observe(roadmapSection);
    }
  </script>
</BaseLayout>

<!-- Shared section styles (hero, stats, rupture, CTA, label, keyframes) -->
<style is:global>
  @import '../styles/sections.css';
</style>

<style>
  /* ========================================
   * Plugins page — page-specific styles only.
   * Shared hero/stats/rupture/CTA/label/keyframes in sections.css.
   * ======================================== */

  /* ---- Tags ---- */
  .tag {
    font-family: var(--font-mono);
    font-size: 11px;
    letter-spacing: 0.05em;
    color: var(--color-fg-secondary);
    padding: 4px 10px;
    border: 1px solid var(--color-border);
    border-radius: 2px;
  }

  /* ---- Plugin Cards (MEDIUM density) ---- */
  .plugins {
    padding: 0;
    opacity: 0;
    transform: translateY(12px);
    transition: opacity 400ms var(--ease-out),
                transform 400ms var(--ease-out);
  }

  .plugins.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .plugins__grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 1px;
    background-color: var(--color-border);
  }

  .plugins__grid + .plugins__grid {
    margin-top: 1px;
  }

  @media (min-width: 768px) {
    .plugins__grid {
      grid-template-columns: 3fr 2fr;
    }
  }

  .plugins__card {
    padding: clamp(32px, 5vh, 56px) clamp(24px, 4vw, 48px);
  }

  .plugins__card--primary {
    background-color: var(--color-bg-elevated);
    min-height: 380px;
    display: flex;
    flex-direction: column;
  }

  .plugins__card--secondary {
    background-color: var(--color-bg-surface);
    display: flex;
    flex-direction: column;
    gap: 32px;
  }

  .plugins__card-bar {
    width: 0;
    height: 2px;
    background-color: var(--color-accent);
    margin-bottom: 24px;
  }

  .plugins.is-visible .plugins__card-bar {
    animation: drawH 400ms var(--ease-out) 200ms forwards;
  }

  .plugins__title {
    font-family: var(--font-display);
    font-size: clamp(1.75rem, 3vw, 2.5rem);
    font-weight: 600;
    letter-spacing: -0.03em;
    line-height: 1.1;
    color: var(--color-fg-emphasis);
    margin-top: 12px;
  }

  .plugins__version {
    font-size: 13px;
    color: var(--color-fg-muted);
    margin-top: 4px;
  }

  .plugins__desc {
    font-size: 14px;
    line-height: 1.7;
    color: var(--color-fg-secondary);
    margin-top: 20px;
    max-width: 480px;
    flex: 1;
  }

  .plugins__tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 24px;
  }

  .plugins__meta {
    display: flex;
    align-items: center;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 20px;
    font-size: 12px;
    color: var(--color-fg-muted);
  }

  .meta__pipe {
    width: 1px;
    height: 12px;
    background: var(--color-border);
  }

  .plugins__link {
    color: var(--color-accent);
    transition: color var(--duration-fast);
  }

  .plugins__link:hover {
    color: var(--color-fg-emphasis);
  }

  /* Status panel */
  .plugins__status {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .status__row {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
  }

  .status__dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .status__dot--active { background-color: var(--color-success); }
  .status__dot--building { background-color: var(--color-accent); }

  .status__text {
    color: var(--color-fg-secondary);
    flex: 1;
  }

  .status__val {
    color: var(--color-fg-muted);
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }

  .status__val--building { color: var(--color-accent); }

  /* Install block */
  .plugins__install {
    margin-top: auto;
    display: flex;
    flex-direction: column;
  }

  .plugins__cmd {
    font-family: var(--font-mono);
    font-size: 13px;
    color: var(--color-fg);
    background: var(--color-bg-elevated);
    padding: 10px 14px;
    border: 1px solid var(--color-border);
    border-radius: 2px;
    user-select: all;
  }

  /* ---- Rupture overrides (HIGH density — terminal build log) ---- */
  .rupture {
    padding: clamp(60px, 10vh, 100px) clamp(24px, 5vw, 64px);
  }

  .rupture__bar {
    top: clamp(60px, 10vh, 100px);
  }

  .rupture__terminal {
    margin-left: clamp(0px, 8%, 120px);
    max-width: 640px;
  }

  .rupture__log {
    margin-top: 16px;
    display: flex;
    flex-direction: column;
  }

  .rupture__entry {
    display: flex;
    gap: 16px;
    padding: 10px 0;
    border-bottom: 1px solid #D6D3CD;
    line-height: 1.5;
  }

  .rupture__ts {
    font-family: var(--font-mono);
    font-size: 11px;
    letter-spacing: 0.1em;
    color: var(--color-fg-muted);
    flex-shrink: 0;
    width: 64px;
    padding-top: 2px;
  }

  .rupture__msg {
    font-family: var(--font-mono);
    font-size: 13px;
    color: #1C1917;
    letter-spacing: 0.02em;
  }

  .rupture__entry--now {
    border-bottom: none;
  }

  .rupture__entry--now .rupture__ts,
  .rupture__entry--now .rupture__msg {
    color: var(--color-accent);
  }

  .rupture__footnote {
    font-family: var(--font-mono);
    font-size: 12px;
    line-height: 1.6;
    color: var(--color-fg-muted);
    margin-top: 32px;
    letter-spacing: 0.02em;
  }

  /* ---- Roadmap ---- */
  .roadmap {
    padding: clamp(60px, 10vh, 100px) clamp(24px, 5vw, 64px);
    opacity: 0;
    transform: translateY(12px);
    transition: opacity 400ms var(--ease-out),
                transform 400ms var(--ease-out);
  }

  .roadmap.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .roadmap__header {
    margin-bottom: 40px;
  }

  .roadmap__header .label {
    margin-top: 20px;
  }

  .roadmap__title {
    font-family: var(--font-display);
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    font-weight: 600;
    letter-spacing: -0.03em;
    line-height: 1.1;
    color: var(--color-fg-emphasis);
    margin-top: 12px;
  }

  .roadmap__list {
    display: flex;
    flex-direction: column;
  }

  .roadmap__item {
    display: flex;
    align-items: center;
    gap: 16px;
    padding: 16px 0;
    border-bottom: 1px solid var(--color-border);
    opacity: 0;
    transform: translateY(8px);
    transition: opacity 300ms var(--ease-out),
                transform 300ms var(--ease-out);
  }

  .roadmap__item.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  .roadmap__idx {
    font-size: 11px;
    color: var(--color-border);
    letter-spacing: 0.1em;
    flex-shrink: 0;
    width: 32px;
  }

  .roadmap__text {
    font-size: clamp(0.875rem, 1.5vw, 1rem);
    color: var(--color-fg);
    flex: 1;
    min-width: 0;
  }

  .roadmap__status {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--color-fg-muted);
    flex-shrink: 0;
    text-align: right;
  }

  .roadmap__status--active { color: var(--color-accent); }

  /* ---- CTA page-specific ---- */
  .cta__link {
    font-family: var(--font-display);
    font-size: clamp(1.5rem, 4vw, 2.5rem);
    font-weight: 500;
    color: var(--color-fg-emphasis);
    text-decoration: underline;
    text-underline-offset: 10px;
    text-decoration-color: var(--color-accent);
    text-decoration-thickness: 2px;
    transition: color var(--duration-fast);
  }

  .cta__link:hover { color: var(--color-accent); }

  .cta__sub {
    margin-top: 16px;
    font-size: 13px;
    color: var(--color-fg-muted);
  }

  /* ---- Reduced Motion (page-specific elements only) ---- */
  @media (prefers-reduced-motion: reduce) {
    .plugins__card-bar {
      width: 40px !important;
    }

    .roadmap__item {
      opacity: 1 !important;
      transform: none !important;
    }
  }

  /* ---- Responsive ---- */
  @media (max-width: 640px) {
    .roadmap__status {
      display: none;
    }

    .roadmap__text {
      font-size: 14px;
    }

    .rupture__entry {
      flex-direction: column;
      gap: 4px;
    }

    .rupture__ts {
      width: auto;
    }
  }
</style>
